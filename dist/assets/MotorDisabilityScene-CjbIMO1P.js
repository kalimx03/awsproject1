import{a as t,j as e}from"./charts-VUD2E1tl.js";import{l as A,A as z,n as T,C as _,O as I,t as P,k as L}from"./index-OIM89d1-.js";import{E as R,C as O,P as B,B as s,T as m,a as F}from"./ContactShadows-BCl5AC67.js";import"./tensorflow-Bdm-eNd5.js";import"./three-BxGoG16y.js";function H({onPositionChange:c,onCollision:u}){const{camera:p}=P(),d=t.useRef(),[o,h]=t.useState([0,1.2,5]),[l,w]=t.useState(0),[y,S]=t.useState(0),[C,M]=t.useState(0),[k,N]=t.useState(!1),f=t.useRef({}),n={maxSpeed:.5,acceleration:.1,deceleration:.05,turnSpeed:.03,width:.75,length:1.2};t.useEffect(()=>{const g=i=>{f.current[i.key.toLowerCase()]=!0},x=i=>{f.current[i.key.toLowerCase()]=!1};return window.addEventListener("keydown",g),window.addEventListener("keyup",x),()=>{window.removeEventListener("keydown",g),window.removeEventListener("keyup",x)}},[]),L((g,x)=>{let i=y,j=C,r=!1;f.current.w?(i=Math.min(i+n.acceleration*x,n.maxSpeed),r=!0):f.current.s?(i=Math.max(i-n.acceleration*x,-.5*.5),r=!0):Math.abs(i)>.01?i*=1-n.deceleration:i=0,Math.abs(i)>.01&&(f.current.a?(j=n.turnSpeed,r=!0):f.current.d?(j=-.03,r=!0):j*=.9);const a=l+j,v=o[0]+Math.sin(a)*i,b=o[2]+Math.cos(a)*i,D=E(v,b,n.width,n.length);if(!D)h([v,o[1],b]),w(a),p&&(p.position.set(v,o[1],b),p.rotation.y=a),c([v,o[1],b]);else{u(D),S(0),M(0);return}S(i),M(j),N(r)});const E=(g,x,i,j)=>{if(Math.abs(g)>15||Math.abs(x)>15)return"boundary";const r=[{x:-10,z:-10,width:8,length:8},{x:10,z:-10,width:10,length:8},{x:-10,z:10,width:6,length:8},{x:10,z:10,width:12,length:8}];for(const a of r)if(g+i/2>a.x-a.width/2&&g-i/2<a.x+a.width/2&&x+j/2>a.z-a.length/2&&x-j/2<a.z+a.length/2)return"building";return null};return e.jsxs("group",{ref:d,position:o,rotation:[0,l,0],children:[e.jsx(s,{args:[n.width,.8,n.length],position:[0,.4,0],children:e.jsx("meshStandardMaterial",{color:"#4169E1",roughness:.8})}),e.jsx(F,{args:[.2,.2,.1],position:[-.75/2-.1,.2,.3],rotation:[Math.PI/2,0,0],children:e.jsx("meshStandardMaterial",{color:"#333333"})}),e.jsx(F,{args:[.2,.2,.1],position:[-.75/2-.1,.2,-.3],rotation:[Math.PI/2,0,0],children:e.jsx("meshStandardMaterial",{color:"#333333"})}),e.jsx(F,{args:[.2,.2,.1],position:[n.width/2+.1,.2,.3],rotation:[Math.PI/2,0,0],children:e.jsx("meshStandardMaterial",{color:"#333333"})}),e.jsx(F,{args:[.2,.2,.1],position:[n.width/2+.1,.2,-.3],rotation:[Math.PI/2,0,0],children:e.jsx("meshStandardMaterial",{color:"#333333"})}),e.jsx(s,{args:[n.width*.8,.8,.1],position:[0,.8,-1.2/2+.2],children:e.jsx("meshStandardMaterial",{color:"#4169E1",roughness:.8})}),e.jsx(s,{args:[.1,.3,n.length*.6],position:[-.75/2-.05,.6,0],children:e.jsx("meshStandardMaterial",{color:"#333333"})}),e.jsx(s,{args:[.1,.3,n.length*.6],position:[n.width/2+.05,.6,0],children:e.jsx("meshStandardMaterial",{color:"#333333"})})]})}function V(){const[c,u]=t.useState(!1),[p,d]=t.useState([5,0,0]);return t.useEffect(()=>{const o=setInterval(()=>{u(h=>!h)},2e4);return()=>clearInterval(o)},[]),t.useEffect(()=>{const o=setInterval(()=>{d([3+Math.random()*4,0,-2+Math.random()*4])},1e4);return()=>clearInterval(o)},[]),e.jsxs(e.Fragment,{children:[e.jsx("ambientLight",{intensity:.4}),e.jsx("directionalLight",{position:[10,20,10],intensity:1,castShadow:!0,"shadow-mapSize":[2048,2048]}),e.jsx(B,{rotation:[-Math.PI/2,0,0],args:[30,30],position:[0,0,0],receiveShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#D3D3D3",roughness:.8})}),e.jsx(s,{args:[30,8,.3],position:[0,4,-15],children:e.jsx("meshStandardMaterial",{color:"#F5F5F5"})}),e.jsx(s,{args:[30,8,.3],position:[0,4,15],children:e.jsx("meshStandardMaterial",{color:"#F5F5F5"})}),e.jsx(s,{args:[.3,8,30],position:[-15,4,0],children:e.jsx("meshStandardMaterial",{color:"#F5F5F5"})}),e.jsx(s,{args:[.3,8,30],position:[15,4,0],children:e.jsx("meshStandardMaterial",{color:"#F5F5F5"})}),e.jsxs("group",{position:[0,0,-14.7],children:[e.jsx(s,{args:[4,.5,2],position:[0,.25,0],children:e.jsx("meshStandardMaterial",{color:"#8B4513"})}),Array.from({length:3},(o,h)=>e.jsx(s,{args:[4,.3,.7],position:[0,.3+h*.3,-.7+h*.7],children:e.jsx("meshStandardMaterial",{color:"#696969"})},h)),e.jsx(m,{position:[0,2,0],fontSize:.3,color:"#FF0000",children:"Main Entrance - Stairs Only"})]}),e.jsxs("group",{position:[-8,0,-14.7],children:[e.jsx(s,{args:[3,.1,8],rotation:[Math.atan2(2,8),0,0],position:[0,1,-4],children:e.jsx("meshStandardMaterial",{color:"#808080"})}),e.jsx(m,{position:[0,2,0],fontSize:.2,color:"#00FF00",children:"Accessible Ramp (1:8 slope - too steep!)"})]}),e.jsxs("group",{position:[8,0,-14.7],children:[e.jsx(s,{args:[3,.1,12],rotation:[Math.atan2(1.5,12),0,0],position:[0,.75,-6],children:e.jsx("meshStandardMaterial",{color:"#808080"})}),e.jsx(m,{position:[0,2,0],fontSize:.2,color:"#00FF00",children:"Accessible Ramp (1:12 slope - ADA compliant)"})]}),e.jsxs("group",{position:[0,0,0],children:[e.jsx(s,{args:[8,8,2],position:[0,4,0],children:e.jsx("meshStandardMaterial",{color:"#C0C0C0"})}),e.jsx(s,{args:[1.5,3,.1],position:[-2.5,2,1.05],children:e.jsx("meshStandardMaterial",{color:"#333333"})}),e.jsx(s,{args:[1.5,3,.1],position:[2.5,2,1.05],children:e.jsx("meshStandardMaterial",{color:"#333333"})}),e.jsx(s,{args:[c?.1:.7,3,.05],position:[-2.85+(c?.3:0),2,1.07],children:e.jsx("meshStandardMaterial",{color:"#C0C0C0"})}),e.jsx(s,{args:[c?.1:.7,3,.05],position:[-2.15-(c?.3:0),2,1.07],children:e.jsx("meshStandardMaterial",{color:"#C0C0C0"})}),e.jsx(s,{args:[.3,.3,.1],position:[-2.5,1,1.1],children:e.jsx("meshStandardMaterial",{color:"#00FF00",emissive:"#00FF00",emissiveIntensity:.5})}),e.jsx(s,{args:[.3,.3,.1],position:[2.5,1,1.1],children:e.jsx("meshStandardMaterial",{color:"#FF0000",emissive:"#FF0000",emissiveIntensity:.5})}),e.jsx(m,{position:[0,6,0],fontSize:.3,color:"#000000",children:"Elevators"})]}),e.jsxs("group",{position:p,children:[e.jsx(s,{args:[1,1.5,.8],position:[0,.75,0],children:e.jsx("meshStandardMaterial",{color:"#FFD700"})}),e.jsx(m,{position:[0,2,0],fontSize:.2,color:"#FF0000",children:"Maintenance Cart"})]}),e.jsxs("group",{position:[-10,0,5],children:[e.jsx(s,{args:[.5,1.2,.3],position:[0,.6,0],children:e.jsx("meshStandardMaterial",{color:"#C0C0C0"})}),e.jsx(m,{position:[0,1.5,0],fontSize:.2,color:"#FF0000",children:'Too High (55")'})]}),e.jsxs("group",{position:[-8,0,5],children:[e.jsx(s,{args:[.5,.8,.3],position:[0,.4,0],children:e.jsx("meshStandardMaterial",{color:"#C0C0C0"})}),e.jsx(m,{position:[0,1.2,0],fontSize:.2,color:"#00FF00",children:'Accessible (40")'})]}),e.jsxs("group",{position:[10,0,10],children:[e.jsx(s,{args:[3,8,.3],position:[0,4,0],children:e.jsx("meshStandardMaterial",{color:"#F5F5F5"})}),e.jsx(s,{args:[.8,3,.1],position:[-1,2,.15],children:e.jsx("meshStandardMaterial",{color:"#8B4513"})}),e.jsx(m,{position:[-1,3,0],fontSize:.2,color:"#FF0000",children:'Too Narrow (28")'}),e.jsx(s,{args:[1.2,3,.1],position:[1,2,.15],children:e.jsx("meshStandardMaterial",{color:"#8B4513"})}),e.jsx(m,{position:[1,3,0],fontSize:.2,color:"#00FF00",children:'Accessible (36")'})]}),e.jsxs("group",{position:[0,0,12],children:[e.jsx(s,{args:[6,8,.3],position:[0,4,0],children:e.jsx("meshStandardMaterial",{color:"#F5F5F5"})}),e.jsx(s,{args:[2,3,.1],position:[0,2,.15],children:e.jsx("meshStandardMaterial",{color:"#8B4513"})}),e.jsx(m,{position:[0,3,0],fontSize:.3,color:"#00FF00",children:"Meeting Room"}),e.jsx(m,{position:[0,5,0],fontSize:.2,color:"#7c3aed",children:"â˜… Destination"})]})]})}function W({position:c,elapsedTime:u,obstaclesHit:p,frustrationLevel:d}){const{scenarioData:o,sessionMetrics:h}=A(),{completedTasks:l}=o;return e.jsxs("div",{className:"fixed inset-0 pointer-events-none z-50",children:[e.jsxs("div",{className:"absolute top-4 left-4 glass-morphism p-4 pointer-events-auto",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Tasks"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`flex items-center gap-2 ${l.includes("enter_building")?"text-green-400":"text-gray-400"}`,children:[e.jsx("span",{children:l.includes("enter_building")?"âœ“":"â—‹"}),e.jsx("span",{children:"Enter Building"})]}),e.jsxs("div",{className:`flex items-center gap-2 ${l.includes("navigate_to_meeting")?"text-green-400":"text-gray-400"}`,children:[e.jsx("span",{children:l.includes("navigate_to_meeting")?"âœ“":"â—‹"}),e.jsx("span",{children:"Navigate to Meeting"})]}),e.jsxs("div",{className:`flex items-center gap-2 ${l.includes("find_facilities")?"text-green-400":"text-gray-400"}`,children:[e.jsx("span",{children:l.includes("find_facilities")?"âœ“":"â—‹"}),e.jsx("span",{children:"Find Facilities"})]})]})]}),e.jsxs("div",{className:"absolute top-4 right-4 glass-morphism p-4 pointer-events-auto",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Performance"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:["Time: ",Math.floor(u/60),":",(u%60).toString().padStart(2,"0")]}),e.jsx("div",{children:"Able-bodied avg: 1:15"}),e.jsxs("div",{children:["Obstacles hit: ",p]}),e.jsxs("div",{children:["Frustration: ",d,"/5"]})]})]}),e.jsx("div",{className:"absolute bottom-4 left-4 glass-morphism p-4 pointer-events-auto",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:["Position: (",c[0].toFixed(1),", ",c[2].toFixed(1),")"]}),e.jsx("div",{children:"WASD - Move"}),e.jsx("div",{children:"A/D - Turn"})]})}),e.jsx("div",{className:"absolute bottom-4 right-4 glass-morphism p-3 pointer-events-auto",children:e.jsx("div",{className:"text-xs text-cyan-accent",children:"ðŸ¦½ ADA Standards"})}),d>=3&&e.jsx("div",{className:"absolute top-20 left-1/2 transform -translate-x-1/2 glass-morphism p-4 pointer-events-auto",children:e.jsx("div",{className:"text-yellow-400 text-sm",children:"ðŸ’¡ Hint: Look for the accessible ramp on the right side of the building"})})]})}function q(){const{setCurrentScene:c,startSession:u,endSession:p,completeTask:d,recordError:o,incrementFrustrationEvents:h,sessionMetrics:l}=A(),[w,y]=t.useState(!0),[S,C]=t.useState([0,1.2,5]),[M,k]=t.useState(0),[N,f]=t.useState(0),[n,E]=t.useState(0),g=t.useRef(Date.now());t.useEffect(()=>{u();const r=setInterval(()=>{k(Math.floor((Date.now()-g.current)/1e3))},1e3);return()=>{clearInterval(r),p()}},[u,p]);const x=t.useCallback(r=>{C(r),r[2]>-13&&!l.completedTasks.includes("enter_building")&&d("enter_building"),r[2]>11&&!l.completedTasks.includes("navigate_to_meeting")&&d("navigate_to_meeting"),Math.abs(r[0]-10)<2&&r[2]>9&&!l.completedTasks.includes("find_facilities")&&d("find_facilities")},[d,l.completedTasks]),i=t.useCallback(r=>{f(a=>a+1),o("collision"),E(a=>{const v=Math.min(a+1,5);return v>=3&&h(),v})},[o,h]),j=()=>{c("dashboard")};return e.jsxs("div",{className:"relative w-full h-screen bg-deep-navy",children:[e.jsx(z,{children:w&&e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 z-50 flex items-center justify-center bg-black/80",children:e.jsxs("div",{className:"glass-morphism p-8 max-w-2xl mx-4",children:[e.jsx("h2",{className:"text-3xl font-bold gradient-text mb-4",children:"Motor Disability Simulation"}),e.jsxs("div",{className:"text-gray-300 space-y-4 mb-6",children:[e.jsx("p",{children:"Experience navigating an office building from a wheelchair:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Find the accessible entrance (avoid stairs)"}),e.jsx("li",{children:"Navigate to the meeting room using elevators"}),e.jsx("li",{children:"Locate accessible facilities"})]}),e.jsx("p",{className:"text-sm text-cyan-accent",children:"Use WASD to move, A/D to turn. The wheelchair has realistic physics with limited turning radius and speed. Watch for obstacles!"})]}),e.jsx("button",{onClick:()=>y(!1),className:"button-primary w-full",children:"Start Simulation"})]})})}),e.jsxs(_,{shadows:!0,camera:{position:[0,1.2,5],fov:75},className:"w-full h-full",children:[e.jsx(V,{}),e.jsx(H,{onPositionChange:x,onCollision:i}),e.jsx(I,{enabled:!1}),e.jsx(R,{preset:"apartment"}),e.jsx(O,{position:[0,-.1,0],opacity:.3})]}),e.jsx(W,{position:S,elapsedTime:M,obstaclesHit:N,frustrationLevel:n}),e.jsx("button",{onClick:j,className:"absolute top-4 left-1/2 transform -translate-x-1/2 glass-morphism px-6 py-2 pointer-events-auto hover:bg-white/20 transition-colors",children:"Exit Simulation"})]})}export{q as default};
